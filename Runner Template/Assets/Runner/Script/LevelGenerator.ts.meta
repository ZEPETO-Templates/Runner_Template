fileFormatVersion: 2
guid: 50770cb481467434a9a7d46e8856de97
importerOverride: ZEPETO.Script.Compiler:ZEPETO.Script:TypescriptAssetImporter
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: -1123457745, guid: 54cf806323ffe4418a4ce4cc63fe6b9d, type: 3}
  isAssemblyDeclarations: 0
  assembly: 
  generateAllTypes: 1
  types: []
  generateWrapper: 0
  overrideWrapperTypes: 0
  wrapperTypes: []
  WrapperFilters: []
  wrapperOutputDirectory: Generated
  compiledResult: '{"source":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\",
    { value: true });\r\nconst __UnityEngine__ = require(\"UnityEngine\");\r\nconst
    UnityEngine_1 = require(\"UnityEngine\");\r\nconst GameManagerRunner_1 = require(\"./GameManagerRunner\");\r\nconst
    BlockPool_1 = require(\"./BlockPool\");\r\nconst MoveBlock_1 = require(\"./MoveBlock\");\r\nconst
    TimerManagerRunner_1 = require(\"./TimerManagerRunner\");\r\nclass LevelGenerator
    extends UnityEngine_1.MonoBehaviour {\r\n    Awake() {\r\n        if (LevelGenerator.Instance
    == null)\r\n            LevelGenerator.Instance = this;\r\n        else\r\n           
    UnityEngine_1.GameObject.Destroy(this);\r\n    }\r\n    Update() {\r\n       
    let time = TimerManagerRunner_1.default.Instance.GetTime();\r\n        let seconds
    = ((time % 60000));\r\n        if (seconds > this.difficultyLevelsTimeLimits[this._currentDifficultyLevel])
    {\r\n            this._currentDifficultyLevel++;\r\n        }\r\n    }\r\n   
    // The first block is activated and positioned, the rest are requested to their
    respective pools\r\n    InitializeLevel() {\r\n        this._currentDifficultyLevel
    = 0;\r\n        this._currentBlocksShowed = [];\r\n        let startBlocSpawnTransform
    = this.startBlockSpawnPoint.transform;\r\n        this.startBlockPrefab.SetActive(true);\r\n       
    this.startBlockPrefab.transform.position = startBlocSpawnTransform.position;\r\n       
    this._firstBlock = this.startBlockPrefab;\r\n        this._currentBlocksShowed.push(this._firstBlock);\r\n       
    this._lastBlock = this._firstBlock;\r\n        this.GenerateBlock();\r\n    }\r\n   
    // To generate a block, a random block pool is selected and then a block is requested\r\n   
    GenerateBlock() {\r\n        let isValidPool = false;\r\n        let n = 0;\r\n       
    while (!isValidPool) {\r\n            n = Math.floor(UnityEngine_1.Random.Range(0,
    this.blockPools.length));\r\n            if (this.blockPools[n].GetComponent($typeof(BlockPool_1.default)).difficultyLevel
    <= this._currentDifficultyLevel) {\r\n                isValidPool = true;\r\n           
    }\r\n        }\r\n        let Pos = this._lastBlock.transform.GetChild(0).transform.position;\r\n       
    let block = this.blockPools[n].GetComponent($typeof(BlockPool_1.default)).getBlock(Pos);\r\n       
    this._lastBlock = block;\r\n        // Each generated block is added to an array
    for later reset and set in motion\r\n        this._currentBlocksShowed.push(block);\r\n       
    this._lastBlock.GetComponent($typeof(MoveBlock_1.default)).SetMoving(GameManagerRunner_1.default.Instance.isGameRunning);\r\n       
    this.SetBlocksSpeed();\r\n    }\r\n    SetBlocksSpeed() {\r\n        this._currentBlocksShowed.forEach(blockElement
    => {\r\n            if (this.levelSpeedByDifficulty[this._currentDifficultyLevel]
    != null) {\r\n                blockElement.GetComponent($typeof(MoveBlock_1.default)).SetSpeed(this.levelSpeedByDifficulty[this._currentDifficultyLevel]);\r\n           
    }\r\n        });\r\n    }\r\n    // This method enables the movement of the blocks
    and additionally defines when the game is running\r\n    SetBlocksMovement(value)
    {\r\n        GameManagerRunner_1.default.Instance.isGameRunning = value;\r\n       
    this._currentBlocksShowed.forEach(blockElement => {\r\n            blockElement.GetComponent($typeof(MoveBlock_1.default)).SetMoving(value);\r\n       
    });\r\n        if (__UnityEngine__.Object.op_Inequality(this._blockToDelete,
    null)) {\r\n            this._blockToDelete.GetComponent($typeof(MoveBlock_1.default)).SetMoving(value);\r\n       
    }\r\n    }\r\n    RemoveLastBlock() {\r\n        this._blockToDelete = this._currentBlocksShowed.shift();\r\n       
    this.RemoveFirstOrReturnToPool(this._blockToDelete);\r\n    }\r\n    ResetLevel()
    {\r\n        this._currentBlocksShowed.forEach(blockElement => {\r\n           
    this.RemoveFirstOrReturnToPool(blockElement);\r\n        });\r\n        this._currentDifficultyLevel
    = 0;\r\n        this._currentBlocksShowed = [];\r\n    }\r\n    // If it is the
    StartBlock, the GameObject is deactivated, if not it is returned to its respective
    pool\r\n    RemoveFirstOrReturnToPool(element) {\r\n        if (__UnityEngine__.Object.op_Equality(element,
    this.startBlockPrefab)) {\r\n            // In case of being the initial block,
    the movement is deactivated\r\n            element.GetComponent($typeof(MoveBlock_1.default)).SetMoving(false);\r\n           
    element.SetActive(false);\r\n        }\r\n        else {\r\n            element.GetComponent($typeof(MoveBlock_1.default)).ReturnToPool();\r\n       
    }\r\n    }\r\n}\r\nexports.default = LevelGenerator;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTGV2ZWxHZW5lcmF0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJMZXZlbEdlbmVyYXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSw2Q0FBdUU7QUFDdkUsMkRBQW9EO0FBQ3BELDJDQUFvQztBQUNwQywyQ0FBb0M7QUFDcEMsNkRBQXNEO0FBRXRELE1BQXFCLGNBQWUsU0FBUSwyQkFBYTtJQXFCOUMsS0FBSztRQUVSLElBQUksY0FBYyxDQUFDLFFBQVEsSUFBSSxJQUFJO1lBQUUsY0FBYyxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7O1lBQy9ELHdCQUFVLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxNQUFNO1FBRUYsSUFBSSxJQUFJLEdBQUcsNEJBQWtCLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBWSxDQUFDO1FBQzNELElBQUksT0FBTyxHQUFHLENBQUMsQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUMvQixJQUFHLE9BQU8sR0FBRyxJQUFJLENBQUMsMEJBQTBCLENBQUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLEVBQzFFO1lBQ0ksSUFBSSxDQUFDLHVCQUF1QixFQUFFLENBQUM7U0FDbEM7SUFDTCxDQUFDO0lBRUQsZ0dBQWdHO0lBQ3pGLGVBQWU7UUFFbEIsSUFBSSxDQUFDLHVCQUF1QixHQUFHLENBQUMsQ0FBQztRQUNqQyxJQUFJLENBQUMsb0JBQW9CLEdBQUcsRUFBRSxDQUFDO1FBQy9CLElBQUksdUJBQXVCLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFNBQVMsQ0FBQztRQUVsRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3RDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsUUFBUSxHQUFHLHVCQUF1QixDQUFDLFFBQVEsQ0FBQztRQUM1RSxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FB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","assetPath":"Assets/Runner/Script/LevelGenerator.ts","manifest":{"properties":[{"assembly":"UnityEngine.CoreModule","name":"blockPools","type":"UnityEngine.GameObject[]","isArray":true,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]},{"assembly":"mscorlib","name":"difficultyLevelsTimeLimits","type":"System.Single[]","isArray":true,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]},{"assembly":"mscorlib","name":"levelSpeedByDifficulty","type":"System.Single[]","isArray":true,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]},{"assembly":"UnityEngine.CoreModule","name":"startBlockPrefab","type":"UnityEngine.GameObject","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]},{"assembly":"UnityEngine.CoreModule","name":"startBlockSpawnPoint","type":"UnityEngine.GameObject","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]}],"name":"LevelGenerator","description":"","hasAnimatorMove":false},"isCompiled":true}'
  typescriptHash: 13208a8f1b82c7bff2ff104c9067d7a8
  onlyWriteTrigger: 0
